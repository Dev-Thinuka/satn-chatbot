<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SA Thomson Nerys Chatbot</title>

  <!-- Styles -->
  <link rel="stylesheet" href="widget.css" />
  <script>
  window.SATN_CONFIG = { API_BASE: "http://localhost:8000/api/v1", TIMEOUT_MS: 15000 };
</script>
<script src="widget.js"></script>
<!-- the hard-bind fallback from step 1 here -->

</head>
<body>
  <!-- Floating Chat Button (single source) -->
  <button id="chat-toggle" class="chat-toggle" aria-label="Open chat">üí¨</button>

  <!-- Chat Widget (single instance) -->
  <div class="chat-widget hidden" id="chat-widget" role="dialog" aria-modal="false" aria-label="Chat with SA Thomson Nerys">
    <div class="chat-header">
      <div class="chat-header-info">
        <img
          src="./boticon.png"
          alt="Kalani"
          class="chat-avatar"
          width="36"
          height="36"
          loading="lazy"
        />
        <div>
          <h2 aria-label="Assistant name">Neryx- AI Assistant</h2>
          <span class="status">üü¢ Online</span>
        </div>
      </div>

      <div class="chat-tools">
        <label for="lang-select" class="sr-only">Language</label>
        <select id="lang-select" class="lang-select" aria-label="Language">
          <option>English</option>
          <option>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</option>
          <option>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
        </select>

        <button id="close-chat" class="chat-close" aria-label="Close chat">‚àí</button>
      </div>
    </div>

    <!-- Messages feed -->
    <div class="chat-body">
      <!-- Welcome message -->
      <div class="bot-message">
        <p>üëã Hello! I‚Äôm Neryx, your SA Thomson Nerys AI assistant. How can I help you today?</p>
        <span class="timestamp"></span>
      </div>
    </div>

    <!-- Footer: quick actions + input row -->
    <div class="chat-footer">
      <div class="quick-replies">
        <button type="button" class=" contact-agent">üìû Contact an Human Agent</button>
        
      </div>

      <div class="chat-input-area">
        <label for="file-upload" class="file-attach-btn" title="Attach file">üìé</label>
        <input id="file-upload" type="file" class="file-input" accept="image/*,.pdf,.doc,.docx" />
        <input type="text" placeholder="Type your message here..." class="chat-input" aria-label="Type your message" />
        <button class="send-btn" aria-label="Send">‚û§</button>
      </div>
    </div>
  </div>

  <!-- Runtime config (single source of truth) -->
  <script>
    window.SATN_CONFIG = {
      API_BASE: "http://localhost:8000/api/v1",
      TIMEOUT_MS: 15000
    };
  </script>

  <!-- Widget logic (binds to existing DOM; does NOT auto-inject second widget/button) -->
  <script src="widget.js"></script>

  <!-- Optional: small helper for the file input + toggle (keep minimal to avoid duplication) -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toggle = document.getElementById("chat-toggle");
      const chat   = document.getElementById("chat-widget");
      const close  = document.getElementById("close-chat");
      const file   = document.getElementById("file-upload");

      toggle.addEventListener("click", () => {
        chat.classList.toggle("hidden");
        toggle.style.display = chat.classList.contains("hidden") ? "block" : "none";
      });

      close.addEventListener("click", () => {
        chat.classList.add("hidden");
        toggle.style.display = "block";
      });

      file.addEventListener("change", (e) => {
        const f = e.target.files[0];
        if (f) console.log("[SATN] File selected:", f.name);
      });
    });
  </script>
  <script>
  // hard-bind toggle/close in case other scripts fail to attach
  document.addEventListener("DOMContentLoaded", () => {
    const btn   = document.getElementById("chat-toggle");
    const panel = document.getElementById("chat-widget");
    const close = document.getElementById("close-chat");

    if (!btn || !panel) {
      console.error("[SATN] toggle/panel not found");
      return;
    }

    // single click handler
    btn.addEventListener("click", () => {
      console.log("[SATN] toggle clicked");
      panel.classList.toggle("hidden");
      btn.style.display = panel.classList.contains("hidden") ? "block" : "none";
    });

    if (close) {
      close.addEventListener("click", () => {
        console.log("[SATN] close clicked");
        panel.classList.add("hidden");
        btn.style.display = "block";
      });
    }
  });
</script>

</body>
</html>
